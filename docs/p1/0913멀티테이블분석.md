# ğŸ“Š í† ìŠ¤ ì•± ë¡œê·¸ ì¤‘ì‹¬ ë©€í‹°í…Œì´ë¸” ë¶„ì„ ê³„íšì„œ

**ì‘ì„±ì¼**: 2025-09-13  
**ë¶„ì„ ëª©í‘œ**: í† ìŠ¤ ì•± ì‚¬ìš© íŒ¨í„´ê³¼ ê°œì¸ ìƒí™œ ë°ì´í„°ì˜ ìƒê´€ê´€ê³„ ë°œêµ´  
**ì¤‘ì‹¬ í…Œì´ë¸”**: `fact_app_logs` (124,622ê°œ ë¡œê·¸, 142ì¼ê°„)  
**ì¡°ì¸ ëŒ€ìƒ**: 4ê°œ íŒ©íŠ¸ í…Œì´ë¸” + 3ê°œ ì°¨ì› í…Œì´ë¸”  

---

## ğŸ¯ ë¶„ì„ ëª©í‘œ ë° ê°€ì„¤

### í•µì‹¬ ê°€ì„¤
1. **ë””ì§€í„¸-ê¸ˆìœµ ì—°ê´€ì„±**: í† ìŠ¤ ì•± ì‚¬ìš©ëŸ‰ ì¦ê°€ â†’ ê¸ˆìœµ ê±°ë˜ í™œë™ ì¦ê°€
2. **ì—ëŸ¬-ìŠ¤íŠ¸ë ˆìŠ¤ ìƒê´€ê´€ê³„**: ì•± ì—ëŸ¬ ë°œìƒ â†’ ë‹¤ë¥¸ í™œë™ íŒ¨í„´ ë³€í™” (ìš´ë™ëŸ‰, ì°½ì‘ëŸ‰)
3. **ì‹œê°„ëŒ€ë³„ ë©€í‹°íƒœìŠ¤í‚¹**: íŠ¹ì • ì‹œê°„ëŒ€ì— ì•± ì‚¬ìš© + ê±°ë˜ + ê¸°íƒ€ í™œë™ ì§‘ì¤‘
4. **ìš”ì¼ë³„ ë””ì§€í„¸ ë¼ì´í”„**: ìš”ì¼ì— ë”°ë¥¸ ì•± ì‚¬ìš© íŒ¨í„´ê³¼ ìƒí™œ ë¦¬ë“¬ ìƒê´€ê´€ê³„
5. **ì•Œë¦¼-ë°˜ì‘ íŒ¨í„´**: notification ë„ë©”ì¸ ë¡œê·¸ì™€ ì¦‰ì‹œ ê±°ë˜ í™œë™ì˜ ì—°ê´€ì„±

---

## ğŸ“‹ ë¶„ì„ ì„¸íŠ¸ ì„¤ê³„

### ğŸ”¥ Priority 1: í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸

#### 1.1 í† ìŠ¤ ì•±-ê¸ˆìœµê±°ë˜ ì‹¤ì‹œê°„ ì—°ê´€ì„± ë¶„ì„
**ê°€ì„¤**: ì•± ì‚¬ìš©ëŸ‰ì´ ë§ì€ ì‹œê°„ëŒ€/ì¼ìì— ê±°ë˜ë„ ë§ì„ ê²ƒ  
**ì¡°ì¸**: `fact_app_logs` â†” `fact_transaction_event` (by event_date, event_hour)

```sql
-- ì‹œê°„ëŒ€ë³„ ì•± ì‚¬ìš©ëŸ‰ vs ê±°ë˜ëŸ‰ ìƒê´€ê´€ê³„
WITH hourly_app AS (
    SELECT 
        event_date, event_hour,
        COUNT(*) as app_logs,
        COUNT(*) FILTER (WHERE app_domain = 'main') as main_usage,
        COUNT(*) FILTER (WHERE log_level = 'error') as error_logs
    FROM iceberg_scan('lake/silver/fact_app_logs')
    GROUP BY event_date, event_hour
),
hourly_trans AS (
    SELECT 
        event_date, 
        EXTRACT(hour FROM datetime) as event_hour,
        COUNT(*) as transactions,
        SUM(ABS(amount)) as total_amount
    FROM iceberg_scan('lake/silver/fact_transaction_event')
    WHERE datetime IS NOT NULL
    GROUP BY event_date, EXTRACT(hour FROM datetime)
)
SELECT 
    a.event_date, a.event_hour,
    a.app_logs, a.main_usage, a.error_logs,
    COALESCE(t.transactions, 0) as transactions,
    COALESCE(t.total_amount, 0) as total_amount,
    -- ìƒê´€ê´€ê³„ ì§€í‘œ
    CASE WHEN a.app_logs > 0 AND COALESCE(t.transactions, 0) > 0 THEN 'BOTH_ACTIVE'
         WHEN a.app_logs > 0 THEN 'ONLY_APP'
         WHEN COALESCE(t.transactions, 0) > 0 THEN 'ONLY_TRANSACTION'
         ELSE 'INACTIVE' END as activity_pattern
FROM hourly_app a
LEFT JOIN hourly_trans t ON a.event_date = t.event_date AND a.event_hour = t.event_hour
ORDER BY a.event_date DESC, a.event_hour;
```

**ê¸°ëŒ€ ì¸ì‚¬ì´íŠ¸**: 
- ì•± ì‚¬ìš© í›„ Në¶„ ë‚´ ê±°ë˜ ë°œìƒ íŒ¨í„´
- ì—ëŸ¬ ë°œìƒ ì‹œê°„ëŒ€ì™€ ê±°ë˜ ì‹¤íŒ¨/ì¬ì‹œë„ ê´€ê³„
- ì‹¤ì‹œê°„ ê¸ˆìœµ í–‰ë™ ì˜ˆì¸¡ ê°€ëŠ¥ì„±

#### 1.2 ì•± ì—ëŸ¬ì™€ ìŠ¤íŠ¸ë ˆìŠ¤ ì§€í‘œ ë¶„ì„  
**ê°€ì„¤**: ì•± ì—ëŸ¬ ë°œìƒì¼ì— ì‹ ì²´ í™œë™ëŸ‰ì´ë‚˜ ì°½ì‘ í™œë™ì´ ë³€í™”í•  ê²ƒ  
**ì¡°ì¸**: `fact_app_logs` â†” `fact_movement` â†” `fact_obsidian_notes` (by event_date)

```sql
-- ì•± ì—ëŸ¬ ë°œìƒì¼ vs ë‹¤ë¥¸ í™œë™ ë³€í™”
WITH daily_app_errors AS (
    SELECT 
        event_date,
        COUNT(*) as total_logs,
        COUNT(*) FILTER (WHERE log_level = 'error') as error_count,
        ROUND(COUNT(*) FILTER (WHERE log_level = 'error') * 100.0 / COUNT(*), 1) as error_rate
    FROM iceberg_scan('lake/silver/fact_app_logs')
    GROUP BY event_date
),
daily_wellness AS (
    SELECT 
        event_date,
        SUM(steps) as daily_steps,
        SUM(active_calories) as daily_calories
    FROM iceberg_scan('lake/silver/fact_movement')
    WHERE steps > 0
    GROUP BY event_date
),
daily_creativity AS (
    SELECT 
        created_date as event_date,
        SUM(word_count) as daily_words
    FROM iceberg_scan('lake/silver/fact_obsidian_notes')
    GROUP BY created_date
)
SELECT 
    e.event_date,
    e.total_logs,
    e.error_count,
    e.error_rate,
    COALESCE(w.daily_steps, 0) as steps,
    COALESCE(w.daily_calories, 0) as calories,
    COALESCE(c.daily_words, 0) as words,
    -- ìŠ¤íŠ¸ë ˆìŠ¤ ì§€ìˆ˜ (ì—ëŸ¬ìœ¨ ê¸°ë°˜)
    CASE 
        WHEN e.error_rate >= 5.0 THEN 'HIGH_STRESS'
        WHEN e.error_rate >= 2.0 THEN 'MEDIUM_STRESS'
        WHEN e.error_rate > 0 THEN 'LOW_STRESS'
        ELSE 'NO_STRESS'
    END as stress_level
FROM daily_app_errors e
LEFT JOIN daily_wellness w ON e.event_date = w.event_date
LEFT JOIN daily_creativity c ON e.event_date = c.event_date
ORDER BY e.error_rate DESC, e.event_date DESC;
```

#### 1.3 ì•Œë¦¼-ë°˜ì‘ ì¦‰ì‹œì„± ë¶„ì„
**ê°€ì„¤**: notification ë¡œê·¸ í›„ main ì‚¬ìš©ê¹Œì§€ì˜ ë°˜ì‘ ì‹œê°„ íŒ¨í„´  
**ì¡°ì¸**: `fact_app_logs` self-join (by event_date, ì‹œê°„ ì°¨ì´ ê³„ì‚°)

```sql
-- ì•Œë¦¼ í›„ ë©”ì¸ ì•± ì‚¬ìš©ê¹Œì§€ì˜ ë°˜ì‘ ì‹œê°„
WITH notification_logs AS (
    SELECT 
        event_date, datetime,
        ROW_NUMBER() OVER (PARTITION BY event_date ORDER BY datetime) as seq
    FROM iceberg_scan('lake/silver/fact_app_logs')
    WHERE app_domain = 'notification'
),
main_logs AS (
    SELECT 
        event_date, datetime,
        ROW_NUMBER() OVER (PARTITION BY event_date ORDER BY datetime) as seq
    FROM iceberg_scan('lake/silver/fact_app_logs')
    WHERE app_domain = 'main'
)
SELECT 
    n.event_date,
    n.datetime as notification_time,
    m.datetime as main_response_time,
    EXTRACT(EPOCH FROM (m.datetime - n.datetime))/60 as response_minutes,
    CASE 
        WHEN EXTRACT(EPOCH FROM (m.datetime - n.datetime))/60 <= 1 THEN 'IMMEDIATE'
        WHEN EXTRACT(EPOCH FROM (m.datetime - n.datetime))/60 <= 5 THEN 'QUICK'
        WHEN EXTRACT(EPOCH FROM (m.datetime - n.datetime))/60 <= 30 THEN 'DELAYED'
        ELSE 'VERY_DELAYED'
    END as response_pattern
FROM notification_logs n
LEFT JOIN main_logs m ON n.event_date = m.event_date 
    AND m.datetime > n.datetime
    AND m.seq = (
        SELECT MIN(seq) FROM main_logs m2 
        WHERE m2.event_date = n.event_date AND m2.datetime > n.datetime
    )
WHERE EXTRACT(EPOCH FROM (m.datetime - n.datetime))/60 <= 60  -- 1ì‹œê°„ ì´ë‚´ ë°˜ì‘ë§Œ
ORDER BY n.event_date DESC, n.datetime DESC
LIMIT 100;
```

### ğŸ” Priority 2: ìƒí™œ íŒ¨í„´ ì‹¬í™” ë¶„ì„

#### 2.1 ë©€í‹°ëª¨ë‹¬ í™œë™ í´ëŸ¬ìŠ¤í„°ë§
**ëª©í‘œ**: í† ìŠ¤ ì•± + ìš´ë™ + ì°½ì‘ + ì‚¬ì§„ì´ ë™ì‹œì— í™œë°œí•œ ë‚  íŒ¨í„´ ë°œêµ´

#### 2.2 ìœ„ì¹˜ ê¸°ë°˜ ì•± ì‚¬ìš© íŒ¨í„´ (Spatial Analysis)
**ì¡°ì¸**: `fact_app_logs` â†” `fact_photo_metadata` (GPS) â†” `dim_bus_stop` (ê·¼ì ‘ì„±)

#### 2.3 ê³„ì ˆì„± ë° íŠ¸ë Œë“œ ë¶„ì„
**ì¡°ì¸**: ëª¨ë“  í…Œì´ë¸” â†” `dim_date` (ì›”ë³„, ìš”ì¼ë³„, ì£¼ë§/í‰ì¼)

### ğŸš€ Priority 3: ì˜ˆì¸¡ ëª¨ë¸ë§ ê¸°ì´ˆ

#### 3.1 ì•± ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê±°ë˜ ì˜ˆì¸¡
#### 3.2 ì—ëŸ¬ íŒ¨í„´ ê¸°ë°˜ ì‚¬ìš©ì„± ê°œì„ 
#### 3.3 ê°œì¸í™”ëœ ê¸ˆìœµ í™œë™ ì‹œì  ì¶”ì²œ

---

## ğŸ› ï¸ ì‹¤í–‰ ê³„íš

### Phase 1: ê¸°ì´ˆ ë°ì´í„° ê²€ì¦ (30ë¶„)
- [ ] í…Œì´ë¸” ê°„ ì¡°ì¸ ê°€ëŠ¥í•œ ë‚ ì§œ ë²”ìœ„ í™•ì¸
- [ ] ë°ì´í„° í’ˆì§ˆ ë° ëˆ„ë½ê°’ íŒ¨í„´ ë¶„ì„
- [ ] ì£¼ìš” ë„ë©”ì¸ë³„ ë¡œê·¸ ë¶„í¬ ì •ì œ

### Phase 2: Priority 1 ë¶„ì„ ì‹¤í–‰ (60ë¶„)
- [ ] 1.1 í† ìŠ¤ ì•±-ê¸ˆìœµê±°ë˜ ì‹¤ì‹œê°„ ì—°ê´€ì„±
- [ ] 1.2 ì•± ì—ëŸ¬ì™€ ìŠ¤íŠ¸ë ˆìŠ¤ ì§€í‘œ 
- [ ] 1.3 ì•Œë¦¼-ë°˜ì‘ ì¦‰ì‹œì„±
- [ ] ê° ë¶„ì„ë³„ CSV ê²°ê³¼ ì €ì¥ ë° ì¿¼ë¦¬ ë¡œê¹…

### Phase 3: ì‹¬í™” ë¶„ì„ (90ë¶„)
- [ ] Priority 2 ìƒí™œ íŒ¨í„´ ë¶„ì„
- [ ] í†µê³„ì  ìœ ì˜ì„± ê²€ì •
- [ ] ìƒê´€ê³„ìˆ˜ ë° íšŒê·€ ë¶„ì„

### Phase 4: ì¸ì‚¬ì´íŠ¸ ì¢…í•© (30ë¶„)
- [ ] í•µì‹¬ ë°œê²¬ì‚¬í•­ ìš”ì•½
- [ ] ì‹¤ìš©ì  í™œìš© ë°©ì•ˆ ë„ì¶œ
- [ ] ì¶”ê°€ ë¶„ì„ ê¸°íšŒ ì‹ë³„

---

## ğŸ“Š ì˜ˆìƒ ì‚°ì¶œë¬¼

### 1. ë¶„ì„ ê²°ê³¼ íŒŒì¼
- `20250913_*_í† ìŠ¤ì•±ê¸ˆìœµê±°ë˜ì—°ê´€ì„±.csv`
- `20250913_*_ì•±ì—ëŸ¬ìŠ¤íŠ¸ë ˆìŠ¤ì§€í‘œ.csv` 
- `20250913_*_ì•Œë¦¼ë°˜ì‘íŒ¨í„´.csv`
- `query_log_20250913.json` (ëª¨ë“  ì¿¼ë¦¬ ê¸°ë¡)

### 2. í•µì‹¬ ì¸ì‚¬ì´íŠ¸
- **ê¸ˆìœµ í–‰ë™ ì˜ˆì¸¡ ê°€ëŠ¥ì„±**: ì•± ì‚¬ìš© â†’ ê±°ë˜ ë°œìƒ ì‹œê°„ ê°„ê²©
- **ë””ì§€í„¸ ì›°ë¹™ ì§€í‘œ**: ì—ëŸ¬ìœ¨ê³¼ ì‹ ì²´/ì •ì‹  í™œë™ ìƒê´€ê´€ê³„
- **ìµœì  UX ê°œì„ ì **: ì•Œë¦¼-ë°˜ì‘ ì‹œê°„ ìµœì í™” ë°©ì•ˆ

### 3. ê°œì¸í™” ì¶”ì²œ ì‹œìŠ¤í…œ ê¸°ì´ˆ
- ê°œì¸ë³„ ìµœì  ê±°ë˜ ì‹œì  ì˜ˆì¸¡
- ì•± ì‚¬ìš© íŒ¨í„´ ê¸°ë°˜ ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬
- ë©€í‹°íƒœìŠ¤í‚¹ íš¨ìœ¨ì„± ê·¹ëŒ€í™” ì‹œê°„ëŒ€

---

## ğŸ”§ ê¸°ìˆ ì  ê³ ë ¤ì‚¬í•­

### ì„±ëŠ¥ ìµœì í™”
- í° í…Œì´ë¸” ì¡°ì¸ ì‹œ ë‚ ì§œ ë²”ìœ„ ì œí•œ
- ì¸ë±ìŠ¤ í™œìš© ê°€ëŠ¥í•œ ì¡°ì¸ í‚¤ ìš°ì„  ì‚¬ìš©
- ê²°ê³¼ í¬ê¸° ì œí•œìœ¼ë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê´€ë¦¬

### ë°ì´í„° í’ˆì§ˆ
- ì‹œê°„ëŒ€ ë¶ˆì¼ì¹˜ ë³´ì • (timezone ê³ ë ¤)
- NULL ê°’ ì²˜ë¦¬ ì „ëµ ëª…í™•í™”
- ì´ìƒì¹˜ íƒì§€ ë° í•„í„°ë§

### ì¿¼ë¦¬ ë¡œê¹…
- ëª¨ë“  ì‹¤í–‰ ì¿¼ë¦¬ JSON í˜•íƒœë¡œ ê¸°ë¡
- ì‹¤í–‰ ì‹œê°„, ê²°ê³¼ í–‰ ìˆ˜, ì—ëŸ¬ ë©”ì‹œì§€ í¬í•¨
- ì¬í˜„ ê°€ëŠ¥ì„±ì„ ìœ„í•œ ì™„ì „í•œ SQL ë³´ì¡´

---

## ğŸ¯ ì„±ê³µ ì§€í‘œ

### ì •ëŸ‰ì  ì§€í‘œ
- [ ] 10ê°œ ì´ìƒ ì˜ë¯¸ìˆëŠ” ìƒê´€ê´€ê³„ íŒ¨í„´ ë°œê²¬
- [ ] í†µê³„ì  ìœ ì˜ì„± (p<0.05) í™•ë³´ëœ ë¶„ì„ 5ê°œ ì´ìƒ
- [ ] ì‹¤í–‰ ê°€ëŠ¥í•œ ê°œì¸í™” ì¶”ì²œ 3ê°œ ì´ìƒ ë„ì¶œ

### ì •ì„±ì  ì§€í‘œ  
- [ ] ê°œì¸ ê¸ˆìœµ í–‰ë™ì˜ ìƒˆë¡œìš´ ì¸ì‚¬ì´íŠ¸ ë°œêµ´
- [ ] ë””ì§€í„¸ ì›°ë¹™ ê°œì„ ì„ ìœ„í•œ êµ¬ì²´ì  ë°©ì•ˆ ì œì‹œ
- [ ] í† ìŠ¤ ì•± UX ìµœì í™” ê´€ì ì—ì„œì˜ ë°œê²¬ì‚¬í•­

---

**ë‹¤ìŒ ë‹¨ê³„**: Phase 1 ê¸°ì´ˆ ë°ì´í„° ê²€ì¦ë¶€í„° ì‹œì‘í•˜ì—¬ ì²´ê³„ì ìœ¼ë¡œ ë¶„ì„ì„ ì§„í–‰í•˜ê³ , ëª¨ë“  ì¿¼ë¦¬ì™€ ê²°ê³¼ë¥¼ ì™„ì „íˆ ê¸°ë¡í•˜ì—¬ ì¬í˜„ ê°€ëŠ¥í•œ ë¶„ì„ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.